
const nodemailer = require('nodemailer');

class mailWrapper{
  constructor(email,password,smtp_server="smtp.gmail.com"){
    this.email=email;
    this.transporter=nodemailer.createTransport({
      host:smtp_server,
      auth: {
        user: email,
        pass: password
      }
    })
  }
  send(from,to,subject,message){
    console.log("from:",from)
    console.log("to:",to)
    const options={
      from:`"${from}" ${this.email}`,
      to:to,
      subject:subject,
      html:message
    }
    this.transporter.sendMail(options,function(err,res){
      if(err){
        console.log(err);
      }else{
        console.log("Sent email.");
      }
    })
  }
}

const init=(email,password,smtp_server)=>{
  return new mailWrapper(email,password,smtp_server)
}

exports.init=init;
