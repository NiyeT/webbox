const randomstring = require("randomstring");

class emailAuth{
  constructor(company,baseUrl,username,email){
    this.baseUrl=baseUrl;
    this.username=username;
    this.email=email;
    this.company=company;
    this.authToken=randomstring.generate(16);
    this.signUpTemplate(baseUrl,username,email);
  }
  signUpTemplate(baseUrl,username,email){
    this.signUpSubject=`
    Welcome to ${this.company}!
    `
    this.template=`
      <span>Thanks for signing up!</span><br>
      <span>Click the link below to authorize your account!</span><br>
      <span>${baseUrl}?action=verify&authToken=${this.authToken}</span>
    `
  }
  recoverySubject(){
    return `Welcome Back to ${this.company}`
  }
  recoveryTemplate(recoveryPassword){
    return `
    <span>Your recovery password is listed below</span><br>
    <span>Recovery Password: ${recoveryPassword}</span>
    `
  }
}

const auth=(company,baseUrl,email,username)=>{
  return new emailAuth(company,baseUrl,username,email);
}

exports.auth=auth;
